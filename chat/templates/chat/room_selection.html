{% extends 'chat/base.html' %}

{% block content %}
<div class="selection-container">
    <h2>Zadejte název místnosti</h2>
    <p>Vytvořte novou místnost nebo vstupte do existující.</p>
    
    <div class="input-group">
        <input type="text" id="room-name-input" placeholder="např. nova-mistnost">
        <button id="room-name-submit">Vstoupit</button>
    </div>

    {% if rooms %}
        <div class="room-list">
            <h3>Nebo vyber z existujících:</h3>
            {% for room in rooms %}
                <a href="{% url 'chat-page' room_name=room.name %}">{{ room.name }}</a>
            {% endfor %}
        </div>
    {% endif %}
</div>

<script>
    // JavaScript zůstává stejný
    document.querySelector('#room-name-input').focus();
    document.querySelector('#room-name-input').onkeyup = function(e) {
        if (e.key === 'Enter') {
            document.querySelector('#room-name-submit').click();
        }
    };
    document.querySelector('#room-name-submit').onclick = function(e) {
        let roomName = document.querySelector('#room-name-input').value.trim();
        if (roomName) {
            const cleanedRoomName = roomName
                .normalize("NFD").replace(/[\u0300-\u036f]/g, "")
                .replace(/\s+/g, '-')
                .replace(/[^\w-]+/g, '')
                .toLowerCase();
            window.location.pathname = '/chat/' + cleanedRoomName + '/';
        }
    };
</script>
{% endblock %}